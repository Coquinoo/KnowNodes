/*** Generated by streamline 0.6.0 (callbacks) - DO NOT EDIT ***/ var __rt=require('streamline/lib/callbacks/runtime').runtime(__filename),__func=__rt.__func,__cb=__rt.__cb; (function() {
  var Error, GraphDB, Neo4j, NodeWrappers;

  Neo4j = require("neo4j");

  GraphDB = require("../DB/GraphDB");

  Error = require("../error/Error");

  module.exports = NodeWrappers = (function() {
    function NodeWrappers() {  };

    NodeWrappers.DB = GraphDB.get();

    NodeWrappers.getNodeType = function() {
      throw Error.notImplemented("NodeWrapperService.getNodeType()"); };


    NodeWrappers.getValidator = function() {
      throw Error.notImplemented("NodeWrapperService.getValidator()"); };


    NodeWrappers.wrap = function(node) {
      throw Error.notImplemented("NodeWrapperService.wrap()"); };


    NodeWrappers.create = function NodeWrappers_create__1(data, _) { var created, __this = this; var __frame = { name: "NodeWrappers_create__1", line: 27 }; return __func(_, this, arguments, NodeWrappers_create__1, 1, __frame, function __$NodeWrappers_create__1() {

        data.KN_ID = __this.GUID();
        data.nodeType = __this.getNodeType();
        data.__CreatedOn__ = Date.now();
        created = __this.wrap(__this.DB.createNode(data));
        return created.save(__cb(_, __frame, 6, 6, function __$NodeWrappers_create__1() {
          return _(null, created); }, true)); }); };


    NodeWrappers.find = function NodeWrappers_find__2(id, _) { var __this = this; var __frame = { name: "NodeWrappers_find__2", line: 37 }; return __func(_, this, arguments, NodeWrappers_find__2, 1, __frame, function __$NodeWrappers_find__2() {
        return __this.findByProperty("KN_ID", id, __cb(_, __frame, 1, 13, _, true)); }); };


    NodeWrappers.findByTextProperty = function NodeWrappers_findByTextProperty__3(key, value, _) { var __this = this; var __frame = { name: "NodeWrappers_findByTextProperty__3", line: 41 }; return __func(_, this, arguments, NodeWrappers_findByTextProperty__3, 2, __frame, function __$NodeWrappers_findByTextProperty__3() {
        return __this.findByProperty(key, value.toLowerCase(), __cb(_, __frame, 1, 13, _, true)); }); };


    NodeWrappers.findByProperty = function NodeWrappers_findByProperty__4(key, value, _) { var node, __this = this; var __frame = { name: "NodeWrappers_findByProperty__4", line: 45 }; return __func(_, this, arguments, NodeWrappers_findByProperty__4, 2, __frame, function __$NodeWrappers_findByProperty__4() {

        return __this.DB.getIndexedNode(__this.getNodeType(), key, value, __cb(_, __frame, 2, 13, function ___(__0, __1) { node = __1;
          if ((node == null)) {
            return _(Error.entityNotFound(__this.getNodeType(), key, value)); }
           else {
            return _(null, __this.wrap(node)); } ; _(); }, true)); }); };



    NodeWrappers.listAll = function NodeWrappers_listAll__5(_) { var nodeWrappers, nodes, params, query, result, wrapped, _i, _len, __this = this; var __frame = { name: "NodeWrappers_listAll__5", line: 55 }; return __func(_, this, arguments, NodeWrappers_listAll__5, 0, __frame, function __$NodeWrappers_listAll__5() {

        query = ["START everyNode = node(*)","WHERE everyNode.nodeType ?= {nodeType}","RETURN everyNode",].join("\n");
        params = {
          nodeType: __this.getNodeType() };

        return __this.DB.query(query, params, __cb(_, __frame, 6, 14, function ___(__0, __1) { nodes = __1;
          nodeWrappers = [];
          for (_i = 0, _len = nodes.length; (_i < _len); _i++) {
            result = nodes[_i];
            wrapped = __this.wrap(result.everyNode);
            nodeWrappers.push(wrapped); };

          return _(null, nodeWrappers); }, true)); }); };


    NodeWrappers.GUID = function() {
      return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(c) {
        var r, v;
        r = ((Math.random() * 16) | 0);
        v = (((c === "x") ? r : ((r & 3) | 8)));
        return v.toString(16); }); };



    return NodeWrappers;

  })();

}).call(this);